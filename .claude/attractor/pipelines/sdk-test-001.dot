digraph "SDK-TEST-001" {
    graph [
        label="SDK Test: Full 4-Layer Write Validation"
        labelloc="t"
        fontsize=16
        rankdir="TB"
        prd_ref="SDK-TEST-001"
        promise_id=""
        target_dir="/Users/theb/Documents/Windsurf/DSPY_PreEmploymentDirectory_PoC"
    ];

    node [fontname="Helvetica" fontsize=11];
    edge [fontname="Helvetica" fontsize=9];

    // Entry
    start [
        shape=Mdiamond
        label="START"
        handler="start"
        status="validated"
        style=filled
        fillcolor=lightgreen
    ];

    // Single codergen node: create a test file
    impl_sdk_write_test [
        shape=box
        label="SDK Write Test:\nCreate hello.py"
        handler="codergen"
        bead_id="SDK-TEST-IMPL"
        worker_type="backend-solutions-engineer"
        acceptance="Create newsletter-agents/hello_sdk.py with a function hello() that returns 'SDK pipeline works!'. Add a test in newsletter-agents/tests/test_hello_sdk.py that asserts hello() returns that string. Run pytest on the new test and ensure it passes."
        prd_ref="SDK-TEST-001"
        status="validated"
        style=filled
        fillcolor="lightgreen"
    ];

    start -> impl_sdk_write_test [label="begin"];

    // Validation gate
    validate_sdk_write_test [
        shape=hexagon
        label="SDK Write Test\nValidation"
        handler="wait.human"
        gate="technical"
        mode="technical"
        bead_id="AT-SDK-TEST"
        acceptance="hello_sdk.py exists with hello() function, test_hello_sdk.py exists and passes pytest"
        status="validated"
        style=filled
        fillcolor="lightgreen"
    ];

    impl_sdk_write_test -> validate_sdk_write_test [label="impl_complete"];

    // Exit
    finalize [
        shape=Msquare
        label="FINALIZE"
        handler="exit"
        status="validated"
        style=filled
        fillcolor="lightgreen"
    ];

    validate_sdk_write_test -> finalize [label="validated"];
}
