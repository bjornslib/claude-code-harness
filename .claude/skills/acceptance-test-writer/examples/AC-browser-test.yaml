# Example browser-type acceptance test

id: AC-user-login
feature: F1
title: "User can log in with valid credentials"
description: |
  A registered user should be able to log in using their email
  and password, and be redirected to the dashboard where they
  see a personalized greeting.

prd_reference: "PRD-AUTH-001, Section 3.1, Requirement R1"

validation_type: browser
priority: critical

preconditions:
  - description: "Test user exists in database"
    details: "Email: test@example.com, Password: TestPass123"
  - description: "User is logged out"
    details: "No active session cookies"

steps:
  - id: step-1
    action: navigate
    target: "/login"
    description: "Navigate to login page"

  - id: step-2
    action: assert_visible
    selector: "[data-testid='login-form']"
    description: "Login form is displayed"
    screenshot: true

  - id: step-3
    action: fill
    selector: "[data-testid='email-input']"
    value: "test@example.com"
    description: "Enter email address"

  - id: step-4
    action: fill
    selector: "[data-testid='password-input']"
    value: "TestPass123"
    description: "Enter password"

  - id: step-5
    action: click
    selector: "[data-testid='login-button']"
    description: "Click login button"

  - id: step-6
    action: wait_for_navigation
    timeout_ms: 5000
    description: "Wait for redirect to complete"

  - id: step-7
    action: assert_url
    pattern: "/dashboard"
    description: "Verify redirected to dashboard"

  - id: step-8
    action: assert_visible
    selector: "[data-testid='user-greeting']"
    contains: "Welcome"
    description: "User greeting is visible with welcome message"
    screenshot: true

expected_outcome: |
  User is redirected to /dashboard and sees personalized greeting.
  Session is established (auth cookie present).
  User can access protected routes.

failure_indicators:
  - "Error message displayed on login form"
  - "Remains on /login page after clicking submit"
  - "401 or 403 HTTP response"
  - "No session cookie created"
  - "Redirect to /login instead of /dashboard"

evidence:
  - type: screenshot
    when: on_step
    step_id: step-2
    filename: "login-form-displayed.png"
    description: "Initial login form state"

  - type: screenshot
    when: on_success
    filename: "login-success-dashboard.png"
    description: "Dashboard after successful login"

  - type: screenshot
    when: on_failure
    filename: "login-failure-state.png"
    description: "State of page when login failed"
