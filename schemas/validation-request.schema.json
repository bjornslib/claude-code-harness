{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "ValidationRequest",
  "description": "Standard message format for System 3 â†’ s3-validator validation requests (PRD-S3-AUTONOMY-001 F4.3)",
  "type": "object",
  "required": ["task_id", "validation_type", "acceptance_criteria"],
  "properties": {
    "task_id": {
      "type": "string",
      "description": "Beads task ID being validated (e.g., claude-harness-setup-5j8t)",
      "pattern": "^[a-z0-9-]+$"
    },
    "prd_id": {
      "type": "string",
      "description": "PRD identifier for E2E validation (e.g., PRD-S3-AUTONOMY-001)",
      "pattern": "^PRD-[A-Z0-9-]+$"
    },
    "validation_type": {
      "type": "string",
      "enum": ["code", "browser", "both"],
      "description": "What kind of validation to perform: code-only, browser-only, or both"
    },
    "acceptance_criteria": {
      "type": "array",
      "description": "List of acceptance criteria to validate against",
      "minItems": 1,
      "items": {
        "type": "object",
        "required": ["id", "description"],
        "properties": {
          "id": {
            "type": "string",
            "description": "Criterion identifier (e.g., AC-1, F4.1-1)"
          },
          "description": {
            "type": "string",
            "description": "Human-readable description of what to validate"
          },
          "validation_hint": {
            "type": "string",
            "description": "Optional hint for how to validate (file path, endpoint, UI element)"
          }
        }
      }
    },
    "claimed_evidence": {
      "type": "object",
      "description": "Evidence the orchestrator/session claims as proof of completion",
      "properties": {
        "summary": {
          "type": "string",
          "description": "Brief summary of what was implemented"
        },
        "files_modified": {
          "type": "array",
          "items": { "type": "string" },
          "description": "List of files the session claims to have modified"
        },
        "test_results": {
          "type": "string",
          "description": "Self-reported test results (to be independently verified)"
        },
        "commit_hash": {
          "type": "string",
          "description": "Git commit hash of the claimed implementation"
        }
      }
    },
    "worktree_path": {
      "type": "string",
      "description": "Absolute path to the git worktree containing the implementation"
    },
    "branch": {
      "type": "string",
      "description": "Git branch name where implementation lives"
    },
    "services": {
      "type": "object",
      "description": "Required services for validation (URLs/ports to check)",
      "properties": {
        "app_url": {
          "type": "string",
          "format": "uri",
          "description": "Application URL for browser validation"
        },
        "api_url": {
          "type": "string",
          "format": "uri",
          "description": "API URL for endpoint validation"
        },
        "required_ports": {
          "type": "array",
          "items": { "type": "integer" },
          "description": "Ports that must be listening for validation to proceed"
        }
      }
    },
    "focus_areas": {
      "type": "array",
      "items": { "type": "string" },
      "description": "Specific areas of concern to prioritize during validation"
    },
    "timeout_seconds": {
      "type": "integer",
      "default": 300,
      "description": "Maximum time allowed for validation (default 5 minutes)"
    }
  }
}
